#![feature(core_intrinsics, rustc_attrs)]
struct Pair<'x>(&'x mut i32, &'x mut i32);

fn swap<'c>(mut p: Pair<'c>) -> Pair<'c> {
    let p1 = &mut *p.1;
    let p0 = &mut *p.0;
    *p0 = 3;
    p.0 = p1;
    p.1 = p0;
    p
}

fn main() {
    let mut x = 1;
    let mut y = 2;
    let p0 = Pair(&mut x, &mut y);
    let p1 = swap(p0);
    assert!(*p1.0 == 2 && *p1.1 == 1);
}
